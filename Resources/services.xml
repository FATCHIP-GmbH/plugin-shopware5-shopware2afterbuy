<?xml version="1.0" encoding="utf-8"?>
<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <services>

        <!-- Commands -->

        <service id="fatchip_afterbuy.commands.import_categories" class="FatchipAfterbuy\Commands\ImportCategories">
            <tag name="console.command" />
            <argument type="service" id="fatchip_afterbuy.services.read_data.external.read_categories_service" />
            <argument type="service" id="fatchip_afterbuy.services.write_data.internal.write_categories_service" />
        </service>

        <service id="fatchip_afterbuy.commands.export_categories" class="FatchipAfterbuy\Commands\ExportCategories">
            <tag name="console.command" />
            <argument type="service" id="fatchip_afterbuy.services.read_data.internal.read_categories_service" />
            <argument type="service" id="fatchip_afterbuy.services.write_data.external.write_categories_service" />
        </service>

        <service id="fatchip_afterbuy.commands.export_orders" class="FatchipAfterbuy\Commands\ExportOrders">
            <tag name="console.command" />
            <argument type="service" id="fatchip_afterbuy.services.read_data.internal.read_orders_service" />
            <argument type="service" id="fatchip_afterbuy.services.write_data.external.write_orders_service" />
        </service>

        <service id="fatchip_afterbuy.commands.import_orders" class="FatchipAfterbuy\Commands\ImportOrders">
            <tag name="console.command" />
            <argument type="service" id="fatchip_afterbuy.services.read_data.external.read_orders_service" />
            <argument type="service" id="fatchip_afterbuy.services.write_data.internal.write_orders_service" />
        </service>

        <service id="fatchip_afterbuy.commands.import_products" class="FatchipAfterbuy\Commands\ImportProducts">
            <tag name="console.command" />
            <argument type="service" id="fatchip_afterbuy.services.read_data.external.read_products_service" />
            <argument type="service" id="fatchip_afterbuy.services.write_data.internal.write_products_service" />
        </service>

        <!-- Products -->

        <service class="FatchipAfterbuy\Services\ReadData\External\ReadProductsService" id="fatchip_afterbuy.services.read_data.external.read_products_service" parent="fatchip_afterbuy.services.abstract_data_service">
            <argument id="models" type="service"/>
            <call method="setTarget">
                <argument type="string">FatchipAfterbuy\ValueObjects\Article</argument>
            </call>
        </service>

        <service class="FatchipAfterbuy\Services\WriteData\Internal\WriteProductsService" id="fatchip_afterbuy.services.write_data.internal.write_products_service" parent="fatchip_afterbuy.services.abstract_data_service">
            <argument id="models" type="service"/>
            <call method="setRepo">
                <argument type="string">\Shopware\Models\Article\Article</argument>
            </call>
            <call method="initHelper">
                <argument type="service" id="fatchip_afterbuy.services.helper.shopware_article_helper"/>
                <argument type="string">number</argument>
                <argument type="string">false</argument>
            </call>
        </service>

        <!-- Orders -->

        <service class="FatchipAfterbuy\Services\ReadData\Internal\ReadOrdersService" id="fatchip_afterbuy.services.read_data.internal.read_orders_service" parent="fatchip_afterbuy.services.abstract_data_service">
            <argument id="models" type="service"/>
            <call method="initHelper">
                <argument type="service" id="fatchip_afterbuy.services.helper.shopware_order_helper"/>
                <argument type="string">number</argument>
                <argument type="string">false</argument>
            </call>
            <call method="setRepo">
                <argument type="string">\Shopware\Models\Order\Order</argument>
            </call>
            <call method="setTarget">
                <argument type="string">FatchipAfterbuy\ValueObjects\Order</argument>
            </call>
        </service>

        <service class="FatchipAfterbuy\Services\ReadData\External\ReadOrdersService" id="fatchip_afterbuy.services.read_data.external.read_orders_service" parent="fatchip_afterbuy.services.abstract_data_service">
            <argument id="models" type="service"/>
            <call method="initHelper">
                <argument type="service" id="fatchip_afterbuy.services.helper.shopware_order_helper"/>
                <argument type="string">number</argument>
                <argument type="string">false</argument>
            </call>
            <call method="setTarget">
                <argument type="string">FatchipAfterbuy\ValueObjects\Order</argument>
            </call>
        </service>

        <service class="FatchipAfterbuy\Services\WriteData\External\WriteOrdersService" id="fatchip_afterbuy.services.write_data.external.write_orders_service" parent="fatchip_afterbuy.services.abstract_data_service">
            <argument id="models" type="service"/>
            <call method="initHelper">
                <argument type="service" id="fatchip_afterbuy.services.helper.shopware_order_helper"/>
                <argument type="string">number</argument>
                <argument type="string">false</argument>
            </call>
        </service>

        <service class="FatchipAfterbuy\Services\WriteData\Internal\WriteOrdersService" id="fatchip_afterbuy.services.write_data.internal.write_orders_service" parent="fatchip_afterbuy.services.abstract_data_service">
            <argument id="models" type="service"/>
            <call method="setRepo">
                <argument type="string">\Shopware\Models\Order\Order</argument>
            </call>
            <call method="initHelper">
                <argument type="service" id="fatchip_afterbuy.services.helper.shopware_order_helper"/>
                <argument type="string">number</argument>
                <argument type="string">false</argument>
            </call>
        </service>

        <!-- Categories -->

        <service class="FatchipAfterbuy\Services\ReadData\External\ReadCategoriesService" id="fatchip_afterbuy.services.read_data.external.read_categories_service" parent="fatchip_afterbuy.services.abstract_data_service">
            <call method="setTarget">
                <argument type="string">FatchipAfterbuy\ValueObjects\Category</argument>
            </call>
        </service>

        <service class="FatchipAfterbuy\Services\WriteData\Internal\WriteCategoriesService" id="fatchip_afterbuy.services.write_data.internal.write_categories_service" parent="fatchip_afterbuy.services.abstract_data_service">
            <argument id="models" type="service"/>
            <call method="initHelper">
                <argument id="fatchip_afterbuy.services.helper.shopware_category_helper" type="service"/>
                <argument type="string">afterbuyCatalogId</argument>
                <argument type="string">true</argument>
            </call>
        </service>

        <service class="FatchipAfterbuy\Services\ReadData\Internal\ReadCategoriesService" id="fatchip_afterbuy.services.read_data.internal.read_categories_service" parent="fatchip_afterbuy.services.abstract_data_service">
            <call method="setTarget">
                <argument type="string">FatchipAfterbuy\ValueObjects\Category</argument>
            </call>
            <call method="initHelper">
                <argument id="fatchip_afterbuy.services.helper.shopware_category_helper" type="service"/>
                <argument type="string">afterbuyCatalogId</argument>
                <argument type="string">true</argument>
            </call>
        </service>

        <service class="FatchipAfterbuy\Services\WriteData\External\WriteCategoriesService" id="fatchip_afterbuy.services.write_data.external.write_categories_service" parent="fatchip_afterbuy.services.abstract_data_service">
            <argument id="models" type="service"/>
              <call method="initHelper">
                <argument id="fatchip_afterbuy.services.helper.shopware_category_helper" type="service"/>
                <argument type="string">afterbuyCatalogId</argument>
                <argument type="string">true</argument>
            </call>
        </service>

        <!-- Abstracts -->

        <service id="fatchip_afterbuy.services.abstract_data_service" class="FatchipAfterbuy\Services\AbstractDataService" abstract="true">
            <call method="setLogger">
                <argument type="service" id="afterbuy.logger" />
            </call>
            <call method="setConfig">
                <argument type="service" id="shopware.plugin.cached_config_reader" />
                <argument type="string">%fatchip_afterbuy.plugin_name%</argument>
            </call>
            <call method="registerAPINamespaces">
                <argument type="string">%fatchip_afterbuy.plugin_dir%</argument>
            </call>
        </service>

        <!-- Helper -->

        <service class="FatchipAfterbuy\Services\Helper\ShopwareOrderHelper" id="fatchip_afterbuy.services.helper.shopware_order_helper">
            <argument id="models" type="service"/>
            <argument type="string">\Shopware\Models\Order\Order</argument>
            <argument type="string">\Shopware\Models\Attribute\Order</argument>
            <argument type="string">getOrder</argument>
            <call method="preFetch">

            </call>
        </service>

        <service class="FatchipAfterbuy\Services\Helper\ShopwareCategoryHelper" id="fatchip_afterbuy.services.helper.shopware_category_helper">
            <argument id="models" type="service"/>
            <argument type="string">\Shopware\Models\Category\Category</argument>
            <argument type="string">\Shopware\Models\Attribute\Category</argument>
            <argument type="string">getCategory</argument>
        </service>

        <service class="FatchipAfterbuy\Services\Helper\ShopwareArticleHelper" id="fatchip_afterbuy.services.helper.shopware_article_helper">
            <argument id="models" type="service"/>
            <argument type="string">\Shopware\Models\Article\Article</argument>
            <argument type="string">\Shopware\Models\Attribute\Attribute</argument>
            <argument type="string">getArticle</argument>
        </service>

        <!-- Logger -->

        <service id="monolog.handler.afterbuy_file" class="Monolog\Handler\StreamHandler" public="false">
            <argument>./var/log/afterbuy.log</argument>
            <argument>-1</argument>
            <call method="pushProcessor">
                <argument type="service" id="monolog.processor.uid" />
            </call>
            <!--
            <call method="setFormatter">
                <argument type="service" id="myproject_mycommand.logger.formatter"/>
            </call>
            -->
        </service>

        <service id="afterbuy.logger" class="Shopware\Components\Logger">
            <argument>Afterbuy</argument>
            <argument type="collection">
                    <argument type="service" id="monolog.handler.afterbuy_file"/>
            </argument>
        </service>

    </services>
</container>
